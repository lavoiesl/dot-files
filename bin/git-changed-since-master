#!/usr/bin/env ruby

require 'shellwords'

ancestor = `git merge-base master HEAD`.strip
files = `git ls-files --others --exclude-standard`.split("\n").map do |file|
  Shellwords.escape(file)
end

`git diff -U0 #{ancestor}`.each_line do |line|
  matches = %r{^\+\+\+ b/(.*)}.match(line)
  next unless matches

  files << Shellwords.escape(matches[1])
end

puts files
